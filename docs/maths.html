<html style="" lang="en" class="js flexbox fontface"><head><meta charset="utf-8"><meta content="width=device-width, initial-scale=1.0" name="viewport"><title>Mathematical Functions - OCaml Scientific Computing</title><link href="css/app.css" rel="stylesheet"><link href="css/prism.css" rel="stylesheet"><script src="js/min/modernizr-min.js"></script><script src="js/prism.js"></script><script src="https://use.typekit.net/gfj8wez.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>try{Typekit.load();}catch(e){}</script></head><body><div class="title-bar"><div class="title"><h1>OCaml Scientific Computing</h1><h5>1<sup>st</sup> Edition (in progress)</h5><nav><a href="index.html">Home</a><a href="toc.html">Table of Contents</a><a href="faqs.html">FAQs</a><a href="install.html">Install</a><a href="https://ocaml.xyz/package/">API Docs</a></nav></div></div><div class="wrap"><div class="left-column"><a class="to-chapter" href="toc.html"><small>Back</small><h5>Table of Contents</h5></a></div><article class="main-body"><section class="level1" id="mathematical-functions">
<h1>Mathematical Functions</h1>
<p>Though the central data structure in Owl is <code>ndarray</code>, we provide support for scalar math functions.</p>
<p>Complex Number</p>
<section class="level2" id="basic-functions">
<h2>Basic Functions</h2>
<p><strong>GUIDE</strong>: categorise unary functions (basic, triangular, log, etc. ), each with some introduction of history and application etc.; not just how this function is used.</p>
<section class="level3" id="binary-functions">
<h3>Binary Functions</h3>
<p>Binary functions <code>f x y</code> has the signature in the form of <code>val f : float -&gt; float -&gt; float</code></p>
<div id="tbl:maths:binary">
<table style="width:97%;">
<caption>Table 1: Binary math functions</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>add</code></td>
<td style="text-align: left;"><code>x + y</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>sub</code></td>
<td style="text-align: left;"><code>x - y</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>mul</code></td>
<td style="text-align: left;"><code>x * y</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>div</code></td>
<td style="text-align: left;"><code>x / y</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>fmod</code></td>
<td style="text-align: left;"><code>x % y</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>atan2</code></td>
<td style="text-align: left;">returns <span class="math inline">\(\arctan(y/x)\)</span>, accounting for the sign of the arguments; this is the angle to the vector <span class="math inline">\((x, y)\)</span> counting from the x-axis.</td>
</tr>
</tbody>
</table>
</div>
</section>
<section class="level3" id="basic-unary-math-functions">
<h3>Basic Unary Math Functions</h3>
<p>Unary functions with signature <code>val f : float -&gt; float</code></p>
<div id="tbl:maths:basic_unary">
<table style="width:97%;">
<caption>Table 2: Basic unary math functions</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>abs</code></td>
<td style="text-align: left;"><code>|x|</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>neg</code></td>
<td style="text-align: left;"><code>-x</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>reci</code></td>
<td style="text-align: left;"><code>1/x</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>floor</code></td>
<td style="text-align: left;">the largest integer that is smaller than <code>x</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ceil</code></td>
<td style="text-align: left;">the smallest integer that is larger than <code>x</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>round</code></td>
<td style="text-align: left;">rounds <code>x</code> towards the bigger integer when on the fence</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>trunc</code></td>
<td style="text-align: left;">integer part of <code>x</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>sqr</code></td>
<td style="text-align: left;"><span class="math inline">\(x^2\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>sqrt</code></td>
<td style="text-align: left;"><span class="math inline">\(\sqrt{x}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>pow</code></td>
<td style="text-align: left;"><span class="math inline">\(x^y\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>hypot</code></td>
<td style="text-align: left;"><span class="math inline">\(\sqrt{x^2 + y^2}\)</span></td>
</tr>
</tbody>
</table>
</div>
</section>
<section class="level3" id="exponential-and-logarithmic-functions">
<h3>Exponential and Logarithmic Functions</h3>
<p>Introduction to exponential and logarithm functions</p>
<div id="tbl:maths:explog">
<table style="width:97%;">
<caption>Table 3: Exponential and logarithmic math functions</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>exp</code></td>
<td style="text-align: left;">exponential <span class="math inline">\(e^x\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>exp2</code></td>
<td style="text-align: left;"><span class="math inline">\(2^x\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>exp10</code></td>
<td style="text-align: left;"><span class="math inline">\(10^x\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>expm1</code></td>
<td style="text-align: left;">returns <span class="math inline">\(\exp(x) - 1\)</span> but more accurate for <span class="math inline">\(x \sim 0\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>log</code></td>
<td style="text-align: left;"><span class="math inline">\(log_e~x\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>log2</code></td>
<td style="text-align: left;"><span class="math inline">\(log_2~x\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>log10</code></td>
<td style="text-align: left;"><span class="math inline">\(log_10~x\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>logn</code></td>
<td style="text-align: left;"><span class="math inline">\(log_n~x\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>log1p</code></td>
<td style="text-align: left;">Inverse of <code>expm1</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>logabs</code></td>
<td style="text-align: left;"><span class="math inline">\(\log(|x|)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>xlogy</code></td>
<td style="text-align: left;"><span class="math inline">\(x \log(y)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>xlog1py</code></td>
<td style="text-align: left;"><span class="math inline">\(x \log(y+1)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>logit</code></td>
<td style="text-align: left;"><span class="math inline">\(\log(p/(1-p))\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>expit</code></td>
<td style="text-align: left;"><span class="math inline">\(1/(1+\exp(-x))\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>log1mexp</code></td>
<td style="text-align: left;"><span class="math inline">\(log(1-exp(x))\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>log1pexp</code></td>
<td style="text-align: left;"><span class="math inline">\(log(1+exp(x))\)</span></td>
</tr>
</tbody>
</table>
</div>
</section>
<section class="level3" id="triangular-functions">
<h3>Triangular Functions</h3>
<p>Introduction of triangular functions</p>
<div id="tbl:maths:triangular">
<table style="width:97%;">
<caption>Table 4: Triangular math functions</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>sin</code></td>
<td style="text-align: left;"><span class="math inline">\(\sin(x)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>cos</code></td>
<td style="text-align: left;"><span class="math inline">\(\cos(x)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>tan</code></td>
<td style="text-align: left;"><span class="math inline">\(\tan(x)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>cot</code></td>
<td style="text-align: left;"><span class="math inline">\(1/\tan(x)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>sec</code></td>
<td style="text-align: left;"><span class="math inline">\(1/\cos(x)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>csc</code></td>
<td style="text-align: left;"><span class="math inline">\(1/\sin(x)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>asin</code></td>
<td style="text-align: left;"><span class="math inline">\(\arcsin(x)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>acos</code></td>
<td style="text-align: left;"><span class="math inline">\(\arcsin(x)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>atan</code></td>
<td style="text-align: left;"><span class="math inline">\(\arctan(x)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>acot</code></td>
<td style="text-align: left;">Inverse function of <code>cot</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>asec</code></td>
<td style="text-align: left;">Inverse function of <code>sec</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>acsc</code></td>
<td style="text-align: left;">Inverse function of <code>csc</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>sinh</code></td>
<td style="text-align: left;"><span class="math inline">\(\sinh(x)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>cosh</code></td>
<td style="text-align: left;"><span class="math inline">\(\cosh(x)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>tanh</code></td>
<td style="text-align: left;"><span class="math inline">\(\tanh(x)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>coth</code></td>
<td style="text-align: left;"><span class="math inline">\(\coth(x)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>sech</code></td>
<td style="text-align: left;"><span class="math inline">\(1/\cosh(x)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>csch</code></td>
<td style="text-align: left;"><span class="math inline">\(1/\sinh(x)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>asinh</code></td>
<td style="text-align: left;">Inverse function of <code>sinh</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>acosh</code></td>
<td style="text-align: left;">Inverse function of <code>cosh</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>atanh</code></td>
<td style="text-align: left;">Inverse function of <code>tanh</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>acoth</code></td>
<td style="text-align: left;">Inverse function of <code>coth</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>asech</code></td>
<td style="text-align: left;">Inverse function of <code>sech</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>acsch</code></td>
<td style="text-align: left;">Inverse function of <code>csch</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>sinc</code></td>
<td style="text-align: left;">returns <span class="math inline">\(\sin(x)/x\)</span> and 1 for <span class="math inline">\(x=0\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>logsinh</code></td>
<td style="text-align: left;">returns <span class="math inline">\(\log(\sinh(x))\)</span> but handles large <span class="math inline">\(|x|\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>logcosh</code></td>
<td style="text-align: left;">returns <span class="math inline">\(\log(\cosh(x))\)</span> but handles large <span class="math inline">\(|x|\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>sindg</code></td>
<td style="text-align: left;">Sine of angle given in degrees</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>cosdg</code></td>
<td style="text-align: left;">Cosine of the angle given in degrees</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>tandg</code></td>
<td style="text-align: left;">Tangent of angle given in degrees</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>cotdg</code></td>
<td style="text-align: left;">Cotangent of the angle given in degrees</td>
</tr>
</tbody>
</table>
</div>
</section>
<section class="level3" id="other-unary-math-functions">
<h3>Other Unary Math Functions</h3>
<div id="tbl:maths:others">
<table style="width:97%;">
<caption>Table 5: Other unary math functions</caption>
<colgroup>
<col style="width: 19%">
<col style="width: 77%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>sigmoid x</code></td>
<td style="text-align: left;"><span class="math inline">\(1 / (1 + \exp(-x))\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>signum x</code></td>
<td style="text-align: left;">Returns the sign of <code>x</code>: -1, 0, or 1.</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>softsign x</code></td>
<td style="text-align: left;">Smoothed <code>sign</code> function</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>relu x</code></td>
<td style="text-align: left;"><span class="math inline">\(\max(0, x)\)</span></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section class="level2" id="special-functions">
<h2>Special Functions</h2>
<p>The definition of numerous special functions of mathematical physics. Special functions are particular mathematical functions that have more or less established names and notations due to their importance in mathematical analysis, functional analysis, physics, or other applications.(COPY) It interfaces to the <a href="http://www.netlib.org/cephes/">Cephes Mathematical Functions Library</a>.</p>
<section class="level3" id="airy-functions">
<h3>Airy Functions</h3>
<p>In the physical sciences, the Airy function (or Airy function of the first kind) Ai(x) is a special function named after the British astronomer George Biddell Airy. (COPY) It is the solution of differential equation:</p>
<p><span class="math display">\[y''(x) = xy(x).\]</span></p>
<p>This differential equation has two linearly independent solutions <code>Ai</code> and <code>Bi</code>. Owl provides the <code>airy</code> to do that:</p>
<div class="highlight">
<pre><code class="language-clike">val airy : float -&gt; float * float * float * float</code></pre>
</div>
<p>The four returned numbers are <code>Ai</code>, its derivative <code>Ai'</code>, <code>Bi</code>, and its derivative <code>Bi'</code>. Let’s look at an example.</p>
<div class="highlight">
<pre><code class="language-ocaml">let x = Mat.linspace (-15.) 5. 200

let y0 = Mat.map (fun x -&gt; 
    let ai, _, _, _ = Maths.airy x in ai
) x 

let y1 = Mat.map (fun x -&gt; 
    let _, _, bi, _ = Maths.airy x in bi
) x 

let _ = 
  let h = Plot.create "special_airy.png" in
  Plot.(plot ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2. ] x y0);
  Plot.(plot ~h ~spec:[ RGB (219, 68,  55); LineStyle 2; LineWidth 2. ] x y1);
  Plot.(set_yrange h (-0.5) 1.);
  Plot.(legend_on h ~position:SouthEast [|"Ai"; "Bi"|]);
  Plot.output h</code></pre>
</div>
<figure>
<img alt="" style="width:75.0%" id="fig:algodiff:airy" title="airy" src="images/maths/example_airy.png"><figcaption>Figure 1: Examples of the two solutions of an Airy equation</figcaption>
</figure>
<p>APPLICATION description</p>
</section>
<section class="level3" id="bessel-functions">
<h3>Bessel Functions</h3>
<p>Bessel functions, first defined by the mathematician Daniel Bernoulli and then generalized by Friedrich Bessel, are canonical solutions y(x) of Bessel’s differential equation:</p>
<p><span class="math display">\[x^2y''+xy'+(x^2 - \alpha^2)y = 0.\]</span></p>
<p>The complex number <span class="math inline">\(\alpha\)</span> is called the <em>order</em> of the bessel function.</p>
<p>The Bessel functions can be divided into two “kinds”. Bessel functions of the first kind <span class="math inline">\(J\)</span> are solutions of Bessel’s differential equation that are finite at <span class="math inline">\(x=0\)</span> integer or positive order and diverge as <span class="math inline">\(x\)</span> approaches zero for negative non-integer order. Bessel functions of the second kind are solutions of the Bessel differential equation that have a singularity at <span class="math inline">\(x=0\)</span> and are multivalued. (COPY ALERT)</p>
<p>A special case is when <span class="math inline">\(x\)</span> is purely imaginary. In this case, the solutions to the Bessel equation are called the <em>modified Bessel functions</em>. These modified Bessel functions can also be categorised as first kind and second kind.</p>
<p>Based on these category, Owl provides these functions.</p>
<div id="tbl:maths:bessel">
<table>
<caption>Table 6: Bessel functions</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 32%">
<col style="width: 56%">
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th style="text-align: left;">Interface</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>j0</code></td>
<td style="text-align: left;"><code>float -&gt; float</code></td>
<td style="text-align: left;">Bessel function of the first kind of order 0</td>
</tr>
<tr class="even">
<td><code>j1</code></td>
<td style="text-align: left;"><code>float -&gt; float</code></td>
<td style="text-align: left;">Bessel function of the first kind of order 1</td>
</tr>
<tr class="odd">
<td><code>jv</code></td>
<td style="text-align: left;"><code>float -&gt; float -&gt; float</code></td>
<td style="text-align: left;">Bessel function of the first kind of real order</td>
</tr>
<tr class="even">
<td><code>y0</code></td>
<td style="text-align: left;"><code>float -&gt; float</code></td>
<td style="text-align: left;">Bessel function of the second kind of order 0</td>
</tr>
<tr class="odd">
<td><code>y1</code></td>
<td style="text-align: left;"><code>float -&gt; float</code></td>
<td style="text-align: left;">Bessel function of the second kind of order 1</td>
</tr>
<tr class="even">
<td><code>yv</code></td>
<td style="text-align: left;"><code>float -&gt; float -&gt; float</code></td>
<td style="text-align: left;">Bessel function of the second kind of real order</td>
</tr>
<tr class="odd">
<td><code>yn</code></td>
<td style="text-align: left;"><code>int -&gt; float -&gt; float</code></td>
<td style="text-align: left;">Bessel function of the second kind of integer order</td>
</tr>
<tr class="even">
<td><code>i0</code></td>
<td style="text-align: left;"><code>float -&gt; float</code></td>
<td style="text-align: left;">Modified Bessel function of order 0</td>
</tr>
<tr class="odd">
<td><code>i1</code></td>
<td style="text-align: left;"><code>float -&gt; float</code></td>
<td style="text-align: left;">Modified Bessel function of order 1</td>
</tr>
<tr class="even">
<td><code>iv</code></td>
<td style="text-align: left;"><code>float -&gt; float -&gt; float</code></td>
<td style="text-align: left;">Modified Bessel function of real order</td>
</tr>
<tr class="odd">
<td><code>i0e</code></td>
<td style="text-align: left;"><code>float -&gt; float</code></td>
<td style="text-align: left;">Exponentially scaled modified Bessel function of order 0</td>
</tr>
<tr class="even">
<td><code>i1e</code></td>
<td style="text-align: left;"><code>float -&gt; float</code></td>
<td style="text-align: left;">Exponentially scaled modified Bessel function of order 1</td>
</tr>
<tr class="odd">
<td><code>k0</code></td>
<td style="text-align: left;"><code>float -&gt; float</code></td>
<td style="text-align: left;">Modified Bessel function of the second kind of order 0</td>
</tr>
<tr class="even">
<td><code>k1</code></td>
<td style="text-align: left;"><code>float -&gt; float</code></td>
<td style="text-align: left;">Modified Bessel function of the second kind of order 1</td>
</tr>
<tr class="odd">
<td><code>k0e</code></td>
<td style="text-align: left;"><code>float -&gt; float</code></td>
<td style="text-align: left;">Exponentially scaled modified Bessel function of the second kind of order 0</td>
</tr>
<tr class="even">
<td><code>k1e</code></td>
<td style="text-align: left;"><code>float -&gt; float</code></td>
<td style="text-align: left;">Exponentially scaled modified Bessel function of the second kind of order 1</td>
</tr>
</tbody>
</table>
</div>
<p>Let’s look at one example.</p>
<div class="highlight">
<pre><code class="language-ocaml">let x = Mat.linspace (0.) 20. 200

let y0 = Mat.map Maths.j0 x

let y1 = Mat.map Maths.j1 x

let y2 = Mat.map (Maths.jv 2.) x

let _ =
  let h = Plot.create "example_bessel.png" in
  Plot.(plot ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2. ] x y0);
  Plot.(plot ~h ~spec:[ RGB (219, 68,  55); LineStyle 2; LineWidth 2. ] x y1);
  Plot.(plot ~h ~spec:[ RGB (244, 180,  0); LineStyle 3; LineWidth 2. ] x y2);
  Plot.(legend_on h ~position:NorthEast [|"j0"; "j1"; "j2"|]);
  Plot.output h</code></pre>
</div>
<figure>
<img alt="" style="width:75.0%" id="fig:algodiff:bessel" title="bessel" src="images/maths/example_bessel.png"><figcaption>Figure 2: Examples of Bessel function of the first kind, with different order</figcaption>
</figure>
<p>(More examples can be added if we want to expand)</p>
<p>Bessel’s equation arises when finding separable solutions to Laplace’s equation and the Helmholtz equation in cylindrical or spherical coordinates. Bessel functions are therefore especially important for many problems of wave propagation and static potentials. In solving problems in cylindrical coordinate systems, one obtains Bessel functions of integer order or half integer order. For example, electromagnetic waves in a cylindrical waveguide, pressure amplitudes of inviscid rotational flows, heat conduction in a cylindrical object, etc. (COPY ALERT)</p>
</section>
<section class="level3" id="elliptic-functions">
<h3>Elliptic Functions</h3>
<div id="tbl:maths:elliptic">
<table>
<caption>Table 7: Elliptic functions</caption>
<colgroup>
<col style="width: 32%">
<col style="width: 67%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>ellipj u m</code></td>
<td style="text-align: left;">Jacobian elliptic functions of parameter <code>m</code> between 0 and 1, and real argument <code>u</code>.</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ellipk m</code></td>
<td style="text-align: left;">Complete elliptic integral of the first kind</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ellipkm1 p</code></td>
<td style="text-align: left;">Complete elliptic integral of the first kind around m = 1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ellipkinc phi m</code></td>
<td style="text-align: left;">Incomplete elliptic integral of the first kind</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ellipe m</code></td>
<td style="text-align: left;">Complete elliptic integral of the second kind</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ellipeinc phi m</code></td>
<td style="text-align: left;">Incomplete elliptic integral of the second kind</td>
</tr>
</tbody>
</table>
</div>
<p>The Jacobian elliptic functions are found in the description of the motion of a pendulum, as well as in the design of the electronic elliptic filters. These functions are periodic, with quarter-period on the real axis equal to the complete elliptic integral. There are twelve Jacobi elliptic functions and <code>ellipj</code> returns three of them: sn, cn, dn. And the fourth result <code>phi</code> is called the amplitude of <code>u</code>. (COPY)</p>
<p>Elliptic integrals arose from the attempts to find the perimeter of an ellipse. elliptic integral. A Elliptic integral function can be expressed in the form of: <span class="math display">\[f(x)=\int_c^xR(t, \sqrt(P(t)))dt,\]</span> where <span class="math inline">\(R\)</span> is a rational function of its two arguments, <span class="math inline">\(P\)</span> is a polynomial of degree 3 or 4 with no repeated roots, and <span class="math inline">\(c\)</span> is a constant. Incomplete elliptic integrals are functions of two arguments; complete elliptic integrals are functions of a single argument. (COPY)</p>
<p>In general, integrals in this form cannot be expressed in terms of elementary functions. Exceptions to this general rule are when P has repeated roots, or when <span class="math inline">\(R(x,y)\)</span> contains no odd powers of y. However, with the appropriate reduction formula, every elliptic integral can be brought into a form that involves integrals over rational functions and the three Legendre canonical forms (i.e.&nbsp;the elliptic integrals of the first, second and third kind). (COPY)</p>
<p>We can use <code>ellipe</code> to compute the circumference of an ellipse. To compute that requires calculus, and the elliptic functions provides a solution. Suppose an ellipse has semi-major axis <span class="math inline">\(a=4\)</span> and semi-minor axis <span class="math inline">\(b=3\)</span>. We an compute its circumference using <span class="math inline">\(4a\textrm{ellipe}(1 - \frac{b^2}{a^2})\)</span>.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let a = 4. ;;
&gt;val a : float = 4.
let b = 3.;;
&gt;val b : float = 3.
let c = 4. *. a *. Maths.(ellipe (1. -. pow (b /. a) 2.));;
&gt;val c : float = 22.1034921607095072
</code></pre>
</div>
</section>
<section class="level3" id="gamma-functions">
<h3>Gamma Functions</h3>
<p>For a positive integer n, the Gamma function is the factorial function.</p>
<p><span class="math display">\[\Gamma(n) = (n-1)!\]</span></p>
<p>For a complex numbers <span class="math inline">\(z\)</span> with a positive real part,</p>
<p><span class="math display">\[\Gamma(z) = \int_0^{\infty}x^{z-1}e^{-x}dx.\]</span></p>
<p>The Gamma function is widely used in a range of areas such as fluid dynamics, geometry, astrophysics, etc. It is especially suitable for describing a common pattern of processes that decay exponentially in time or space. The Gamma function and related function provided in Owl are list in tbl.&nbsp;8.</p>
<div id="tbl:maths:gamma">
<table>
<caption>Table 8: Gamma functions</caption>
<colgroup>
<col style="width: 32%">
<col style="width: 67%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>gamma z</code></td>
<td style="text-align: left;">Returns the value of the Gamma function</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>rgamma z</code></td>
<td style="text-align: left;">Reciprocal of the Gamma function</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>loggamma z</code></td>
<td style="text-align: left;">Principal branch of the logarithm of the Gamma function</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>gammainc a x</code></td>
<td style="text-align: left;">Regularized lower incomplete gamma function</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>gammaincinv a y</code></td>
<td style="text-align: left;">Inverse function of <code>gammainc</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>gammaincc a x</code></td>
<td style="text-align: left;">Complemented incomplete gamma integral</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>gammainccinv a y</code></td>
<td style="text-align: left;">Inverse function of <code>gammaincc</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>psi z</code></td>
<td style="text-align: left;">The digamma function</td>
</tr>
</tbody>
</table>
</div>
<p>The incomplete gamma functions are similarly to the gamma function but with different or “incomplete” integral limits. The gamma function is defined as an integral from zero to infinity. This contrasts with the lower incomplete gamma function, which is defined as an integral from zero to a variable upper limit. Similarly, the upper incomplete gamma function is defined as an integral from a variable lower limit to infinity. The digamma function is defined as the logarithmic derivative of the gamma function. (COPY)</p>
<p>Here is an example of using <code>gamma</code>.</p>
<div class="highlight">
<pre><code class="language-ocaml">let x = Mat.linspace (-3.5) 5. 2000

let y = Mat.map Maths.gamma x

let _ =
  let h = Plot.create "example_gamma.png" in
  Plot.(plot ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2. ] x y);
  Plot.(set_yrange h (-10.) 20.);
  Plot.output h</code></pre>
</div>
<figure>
<img alt="" style="width:75.0%" id="fig:algodiff:gamma" title="gamma" src="images/maths/example_gamma.png"><figcaption>Figure 3: Examples of Gamma function along part of the real axis</figcaption>
</figure>
<p>(TODO: this figure should not have the vertical lines)</p>
</section>
<section class="level3" id="beta-functions">
<h3>Beta Functions</h3>
<p>Beta function is defined as:</p>
<p><span class="math display">\[B(x,y) = \int_0^1t^{x-1}(1-t)^{y-1}dt = \frac{\Gamma(x)\Gamma(y)}{\Gamma(x+y)}\]</span></p>
<p>The incomplete beta function extends this definition to:</p>
<p><span class="math display">\[B(x, a, b) = \int_0^xt^{a-1}(1-t)^{b-1}dt.\]</span></p>
<p>They are both included in the special functions provided by Owl.</p>
<div id="tbl:maths:beta">
<table>
<caption>Table 9: Beta functions</caption>
<colgroup>
<col style="width: 32%">
<col style="width: 67%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>beta x y</code></td>
<td style="text-align: left;">Beta function</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>betainc a b x</code></td>
<td style="text-align: left;">Incomplete Beta integral</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>betaincinv a b y</code></td>
<td style="text-align: left;">Inverse function of <code>betainc</code></td>
</tr>
</tbody>
</table>
</div>
<p>The Beta function has several properties:</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = Maths.beta 3. 4. ;;
&gt;val x : float = 0.0166666666666666664
let y = Maths.((gamma 3.) *. (gamma 4.) /. (gamma (7.))) ;;
&gt;val y : float = 0.0166666666666666664
</code></pre>
</div>
<p>This validate the relationship between beta funtion and gamma function. Another property of beta function is it is symmetric, which means <span class="math inline">\(B(x,y) = B(y, x)\)</span>.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">let x = Maths.beta 3. 4. ;;
&gt;val x : float = 0.0166666666666666664
let y = Maths.beta 4. 3. ;;
&gt;val y : float = 0.0166666666666666664
</code></pre>
</div>
<p>Beta function is the first known scattering amplitude in String theory in physics. It can also be used to model a preferential attachment process, which describes the distribution of resources among individuals based on the resource amount they already have. (COPY)</p>
</section>
<section class="level3" id="struve-functions">
<h3>Struve Functions</h3>
<p>The Struve function is defined as: <span class="math display">\[H_v(x) = (z/2)^{v + 1} \sum_{n=0}^\infty \frac{(-1)^n (z/2)^{2n}}{\Gamma(n + \frac{3}{2}) \Gamma(n + v + \frac{3}{2})},\]</span></p>
<p>where <span class="math inline">\(\Gamma\)</span> is the gamma funcction. <span class="math inline">\(x\)</span> must be positive unless <span class="math inline">\(v\)</span> is an integer. The function <code>struve v x</code> returns the value of Struve function. The paramter <span class="math inline">\(v\)</span> is called the <em>order</em> of this Struve function. Here is an example.</p>
<div class="highlight">
<pre><code class="language-ocaml">let _ =
  let h = Plot.create "example_struve.png" in
  Plot.(plot_fun ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2.] (Maths.struve 0.) (-12.) 12.);
  Plot.(plot_fun ~h ~spec:[ RGB (219, 68,  55); LineStyle 2; LineWidth 2.] (Maths.struve 1.) (-12.) 12.);
  Plot.(plot_fun ~h ~spec:[ RGB (244, 180,  0); LineStyle 3; LineWidth 2.] (Maths.struve 2.) (-12.) 12.);
  Plot.(plot_fun ~h ~spec:[ RGB (77,  81,  57); LineStyle 1; LineWidth 2.] (Maths.struve 3.) (-12.) 12.);
  Plot.(plot_fun ~h ~spec:[ RGB (111, 51, 129); LineStyle 2; LineWidth 2.] (Maths.struve 4.) (-12.) 12.);
  Plot.(set_yrange h (-3.) 5.);
  Plot.(legend_on h ~position:SouthEast [|"H0"; "H1"; "H2"; "H3"; "H4"|]);
  Plot.output h</code></pre>
</div>
<figure>
<img alt="" style="width:75.0%" id="fig:algodiff:struve" title="struve" src="images/maths/example_struve.png"><figcaption>Figure 4: Examples of Struve function for different orders.</figcaption>
</figure>
<p>Struve functions have some specific uses across many different fields of physics in a wide variety of applications. For example, they can be found in water-wave and surface-wave problems (specifically flow of liquid near a turning ship) as well as calculations to do with the distribution of fluid pressure over a vibrating disk and other unsteady aerodynamics. They also crop up when considering aspects of optical diffraction, plasma stability (specifically resistive magnetohydrodynamics instability theory), quantum dynamical studies of spin decoherence and excitation in carbon nanotubes. (<a href="https://www.nag.co.uk/content/struve-functions">COPY</a>)</p>
</section>
<section class="level3" id="zeta-functions">
<h3>Zeta Functions</h3>
<p>The Hurwitz zeta function <code>zeta x q</code> returns the Hurwitz zeta function:</p>
<p><span class="math display">\[\zeta(x, q) = \sum_{k=0}^{\infty}\frac{1}{(k+q)^x}.\]</span></p>
<p>When <span class="math inline">\(q\)</span> is set to 1, this function is reduced to Riemann zeta function. The function <code>zetac x</code> returns Riemann zeta function minus 1. We can evaluate the zeta function at certain points, for example:</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">Maths.zeta 4. 1. ;;
&gt;- : float = 1.08232323371113837
(Maths.pow Owl_const.pi 4.) /. 90.;;
&gt;- : float = 1.08232323371113792
</code></pre>
</div>
<p>The Riemann zeta function plays a pivotal role in analytic number theory and has applications in physics, probability theory, and applied statistics. Zeta function regularization is used as one possible means of regularization of divergent series and divergent integrals in quantum field theory. In one notable example, the Riemann zeta-function shows up explicitly in one method of calculating the Casimir effect. The zeta function is also useful for the analysis of dynamical systems. (COPY)</p>
</section>
<section class="level3" id="error-functions">
<h3>Error Functions</h3>
<p>The error functions are not about error processing in programming. In mathematics, it is defined as: <span class="math display">\[\frac{2}{\sqrt{\pi}}\int_0^x e^{-t^2})dt.\]</span></p>
<div id="tbl:maths:error">
<table>
<caption>Table 10: Error functions</caption>
<colgroup>
<col style="width: 32%">
<col style="width: 67%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>erf x</code></td>
<td style="text-align: left;">Error function</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>erfc x</code></td>
<td style="text-align: left;">Complementary error function: <span class="math inline">\(1 - \textrm{erf}(x)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>erfcx x</code></td>
<td style="text-align: left;">Scaled complementary error function: <span class="math inline">\(\exp(x^2) \mathrm{erfc}(x)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>erfinv x</code></td>
<td style="text-align: left;">Inverse function of <code>erf</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>erfcinv x</code></td>
<td style="text-align: left;">Inverse function of <code>erfc</code></td>
</tr>
</tbody>
</table>
</div>
<p>The error function is a sigmoid function. We can observe its shape by the code below.</p>
<div class="highlight">
<pre><code class="language-ocaml">let _ =
  let h = Plot.create "example_erf.png" in
  Plot.(plot_fun ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2.] Maths.erf (-3.) 3.);
  Plot.output h</code></pre>
</div>
<figure>
<img alt="" style="width:75.0%" id="fig:algodiff:erf" title="struve" src="images/maths/example_erf.png"><figcaption>Figure 5: Plot of the Error function.</figcaption>
</figure>
<p>The error function occurs often in probability, statistics, and partial differential equations describing diffusion. In statistics, for nonnegative values of x, the error function has the following interpretation: for a random variable <code>Y</code> that is normally distributed with mean 0 and variance 0.5, then <code>erf x</code> is the probability that <code>Y</code> falls in the range <code>[-x, x]</code>. (COPY)</p>
</section>
<section class="level3" id="integral-functions">
<h3>Integral Functions</h3>
<p>Owl also provides several special integral functions. The Dawson function is defined as: <span class="math display">\[D(x) = e^{-x^2}\int_0^x~e^{t^2}dt\]</span></p>
<p>And the Fresnel trigonometric integral returns a tuple that contains two parts: <span class="math display">\[S(x) = \int_0^x~sin(t^2)dt, C(x) = \int_0^x~cos(t^2)dt.\]</span></p>
<p>We can observe the functions of these integrals with plots.</p>
<div class="highlight">
<pre><code class="language-ocaml">let _ =
  let h = Plot.create ~m:1 ~n:2 "example_integrals.png" in
  Plot.subplot h 0 0;
  Plot.(plot_fun ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2.] Maths.dawsn (-5.) 5.);
  Plot.set_ylabel h "dawsn(x)";
  Plot.subplot h 0 1;
  Plot.(plot_fun ~h ~spec:[ RGB (66, 133, 244); LineStyle 1; LineWidth 2.] (fun x -&gt; let s, _ = Maths.fresnel x in s) 0. 5.);
  Plot.(plot_fun ~h ~spec:[ RGB (219, 68,  55); LineStyle 2; LineWidth 2.] (fun x -&gt; let _, c = Maths.fresnel x in c) 0. 5.);
  Plot.(legend_on h ~position:SouthEast [|"S(x)"; "C(x)"|]);
  Plot.set_ylabel h "fresnel(x)";
  Plot.output h</code></pre>
</div>
<figure>
<img alt="" style="width:100.0%" id="fig:algodiff:integrals" title="integrals" src="images/maths/example_integrals.png"><figcaption>Figure 6: Plot of the Dawson and Fresnel integral function.</figcaption>
</figure>
<p>Besides these two, other type of special integral functions are also provided, as shown in tbl.&nbsp;11.</p>
<div id="tbl:maths:integral">
<table>
<caption>Table 11: Integral functions</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Function</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>expn n x</code></td>
<td style="text-align: left;">Generalized exponential integral <span class="math inline">\(E_n(x) = x^{n-1}\int_x^{\infty}\frac{e^{-t}}{t^n}dt\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>shi x</code></td>
<td style="text-align: left;">Hyperbolic sine integral: <span class="math inline">\(\int_0^x~\frac{\sinh~t}{t}dt\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>chi x</code></td>
<td style="text-align: left;">Hyperbolic cosine integral: <span class="math inline">\(\gamma + \log(x) + \int_0^x~\frac{\cosh~t -1}{t}dt\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>shichi x</code></td>
<td style="text-align: left;">(<code>shi x</code>, <code>chi x</code>)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>si x</code></td>
<td style="text-align: left;">Sine integral: <span class="math inline">\(\int_0^x~\frac{\sin~t}{t}dt\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ci x</code></td>
<td style="text-align: left;">Cosine integral: <span class="math inline">\(\gamma + \log(x) + \int_0^x~\frac{\cos~t -1}{t}dt\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>sici x</code></td>
<td style="text-align: left;">(<code>si x</code>, <code>ci x</code>)</td>
</tr>
</tbody>
</table>
</div>
<p>Dawson integrals is motivated by research on the electromagnetic radiation propagation across the surface of earth. The Fresnel integrals were originally used in the calculation of the electromagnetic field intensity in an environment where light bends around opaque objects. More recently, they have been used in the design of highways and railways, specifically their curvature transition zones. Other applications are roller coasters or calculating the transitions on a velodrome track to allow rapid entry to the bends and gradual exit. (<a href="https://en.wikipedia.org/wiki/Fresnel_integral">COPY</a>)</p>
</section>
</section>
<section class="level2" id="factorials">
<h2>Factorials</h2>
<div class="highlight">
<pre><code class="language-clike">val fact : int -&gt; float
(** Factorial function ``fact n`` calculates :math:`n!`. *)

val log_fact : int -&gt; float
(** Logarithm of factorial function ``log_fact n`` calculates :math:`\log n!`. *)

val doublefact : int -&gt; float
(** Double factorial function ``doublefact n`` calculates
:math:`n!! = n(n-2)(n-4)\dots 2` or :math:`\dots 1` *)

val log_doublefact : int -&gt; float
(** Logarithm of double factorial function. *)

val permutation : int -&gt; int -&gt; int
(** ``permutation n k`` returns the number :math:`n!/(n-k)!` of ordered subsets
 * of length :math:`k`, taken from a set of :math:`n` elements. *)

val permutation_float : int -&gt; int -&gt; float
(**
``permutation_float`` is like ``permutation`` but deals with larger range.
 *)

val combination : int -&gt; int -&gt; int
(** ``combination n k`` returns the number :math:`n!/(k!(n-k)!)` of subsets of k elements
    of a set of n elements. This is the binomial coefficient
    :math:`\binom{n}{k}` *)

val combination_float : int -&gt; int -&gt; float
(** ``combination_float`` is like ``combination`` but can deal with a larger range. *)

val log_combination : int -&gt; int -&gt; float
(** ``log_combination n k`` returns the logarithm of :math:`\binom{n}{k}`. *)</code></pre>
</div>
</section>
<section class="level2" id="interpolation-and-extrapolation">
<h2>Interpolation and Extrapolation</h2>
</section>
<section class="level2" id="utility-functions">
<h2>Utility Functions</h2>
<div class="highlight">
<pre><code class="language-clike">val is_prime : int -&gt; bool
(** returns true if x is a prime number. 
The function is deterministic for all numbers representable by an int. The function uses the Rabin-Miller primality test.
*)

val fermat_fact : int -&gt; int * int
(**
``fermat_fact x`` performs Fermat factorisation over ``x``, i.e. into two
roughly equal factors. ``x`` must be an odd number.
 *)

val nextafter : float -&gt; float -&gt; float
(** ``nextafter from to`` returns the next representable double precision value
of ``from`` in the direction of ``to``. If ``from`` equals ``to``, this value
is returned.
 *)

val nextafterf : float -&gt; float -&gt; float
(** ``nextafter from to`` returns the next representable single precision value
of ``from`` in the direction of ``to``. If ``from`` equals ``to``, this value
is returned.
 *)
</code></pre>
</div>
</section>
</section>
</article></div><a href="stats.html" class="next-chapter"><div class="content"><h1><small>Next: Chapter 05</small>Statistical Functions</h1></div></a><footer><div class="content"><ul><li><a href="http://ocaml.xyz">ocaml.xyz</a></li><li><a href="https://github.com/ryanrhymes">GitHub</a></li></ul><p>Copyright 2017-2020 Liang Wang.</p></div></footer><script src="js/jquery.min.js"></script><script src="js/min/app-min.js"></script></body></html>