<html style="" lang="en" class="js flexbox fontface"><head><meta charset="utf-8"><meta content="width=device-width, initial-scale=1.0" name="viewport"><title>Statistical Functions - OCaml Scientific Computing</title><link href="css/app.css" rel="stylesheet"><link href="css/prism.css" rel="stylesheet"><script src="js/min/modernizr-min.js"></script><script src="js/prism.js"></script><script src="https://use.typekit.net/gfj8wez.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>try{Typekit.load();}catch(e){}</script></head><body><div class="title-bar"><div class="title"><h1>OCaml Scientific Computing</h1><h5>1<sup>st</sup> Edition (in progress)</h5><nav><a href="index.html">Home</a><a href="toc.html">Table of Contents</a><a href="faqs.html">FAQs</a><a href="install.html">Install</a><a href="https://ocaml.xyz/package/">API Docs</a></nav></div></div><div class="wrap"><div class="left-column"><a class="to-chapter" href="toc.html"><small>Back</small><h5>Table of Contents</h5></a></div><article class="main-body"><section class="level1" id="statistical-functions">
<h1>Statistical Functions</h1>
<p>Statistics is an indispensable tool for data analysis, it helps us to gain the insights from data. The statistical functions in Owl can be categorised into three groups: descriptive statistics, distributions, and hypothesis tests.</p>
<section class="level2" id="random-variables">
<h2>Random Variables</h2>
<section class="level3" id="discrete-random-variables">
<h3>Discrete Random Variables</h3>
</section>
<section class="level3" id="continuous-random-variables">
<h3>Continuous Random Variables</h3>
</section>
<section class="level3" id="descriptive-statistics">
<h3>Descriptive Statistics</h3>
<p>Descriptive statistics are used to summarise the characteristics of data. The commonly used ones are mean, variance, standard deviation, skewness, kurtosis, and etc.</p>
<p>We first draw one hundred random numbers which are uniformly distributed between 0 and 10. Here we use <code>Stats.uniform_rvs</code> function to generate numbers following uniform distribution.</p>
<div class="highlight">
<pre><code class="language-ocaml">let data = Array.init 100 (fun _ -&gt; Stats.uniform_rvs 0. 10.);;</code></pre>
</div>
<p>Then We use <code>mean</code> function calculate sample average. As we can see, it is around 5. We can also calculate higher moments such as variance and skewness easily with corresponding functions.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">Stats.mean data;;
&gt;- : float = 5.39282409364656168
Stats.std data;;
&gt;- : float = 2.82512008501752376
Stats.var data;;
&gt;- : float = 7.98130349476942147
Stats.skew data;;
&gt;- : float = -0.100186978462459622
Stats.kurtosis data;;
&gt;- : float = 1.90668234297861283
</code></pre>
</div>
<p>The following code calculates different central moments of <code>data</code>. A central moment is a moment of a probability distribution of a random variable about the random variable’s mean. The zeroth central moment is always 1, and the first is close to zero, and the second is close to the variance.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">Stats.central_moment 0 data;;
&gt;- : float = 1.
Stats.central_moment 1 data;;
&gt;- : float = 5.3290705182007512e-17
Stats.central_moment 2 data;;
&gt;- : float = 7.90149045982172549
Stats.central_moment 3 data;;
&gt;- : float = -2.25903009746890815
</code></pre>
</div>
</section>
<section class="level3" id="order-statistics">
<h3>Order Statistics</h3>
<p>Order statistics and rank statistics are among the most fundamental tools in non-parametric statistics and inference. The <span class="math inline">\(k^{th}\)</span> order statistic of a statistical sample is equal to its kth-smallest value. The example functions of ordered statistics are as follows.</p>
<div class="highlight">
<pre><code class="language-ocaml">Stats.min;; (* the mininum of the samples *)
Stats.max;; (* the maximum of the samples *)
Stats.median;; (* the median value of the samples *)
Stats.quartile;; (* quartile of the samples *)
Stats.first_quartile;; (* the first quartile of the samples *)
Stats.third_quartile;; (* the third quartile of the samples *)
Stats.interquartile;; (* the interquartile of the samples *)
Stats.percentile;; (* percentile of the samples *)</code></pre>
</div>
<p>In addition to the aforementioned ones, there are many other ordered statistical functions in Owl for you to explore.</p>
</section>
</section>
<section class="level2" id="special-distribution">
<h2>Special Distribution</h2>
<p>Stats module supports many distributions. For each distribution, there is a set of related functions using the distribution name as their common prefix.</p>
<section class="level3" id="poisson-distribution">
<h3>Poisson Distribution</h3>
</section>
<section class="level3" id="gaussian-distribution">
<h3>Gaussian Distribution</h3>
<p>Here we use Gaussian distribution as an example to illustrate the naming convention.</p>
<ul>
<li><code>gaussian_rvs</code> : random number generator.</li>
<li><code>gaussian_pdf</code> : probability density function.</li>
<li><code>gaussian_cdf</code> : cumulative distribution function.</li>
<li><code>gaussian_ppf</code> : percent point function (inverse of CDF).</li>
<li><code>gaussian_sf</code> : survival function (1 - CDF).</li>
<li><code>gaussian_isf</code> : inverse survival function (inverse of SF).</li>
<li><code>gaussian_logpdf</code> : logarithmic probability density function.</li>
<li><code>gaussian_logcdf</code> : logarithmic cumulative distribution function.</li>
<li><code>gaussian_logsf</code> : logarithmic survival function.</li>
</ul>
<p>We generate two data sets in this example, and both contain 999 points drawn from different Gaussian distribution <span class="math inline">\(\mathcal{N} (\mu, \sigma^{2})\)</span>. For the first one, the configuration is <span class="math inline">\((\mu = 1, \sigma = 1)\)</span>; whilst for the second one, the configuration is <span class="math inline">\((\mu = 12, \sigma = 3)\)</span>.</p>
<div class="highlight">
<pre><code class="language-ocaml">let noise sigma = Stats.gaussian_rvs ~mu:0. ~sigma;;
let x = Array.init 999 (fun _ -&gt; Stats.gaussian_rvs ~mu:1. ~sigma:1.);;
let y = Array.init 999 (fun _ -&gt; Stats.gaussian_rvs ~mu:12. ~sigma:3.);;</code></pre>
</div>
<p>We can visualise the data sets using histogram plot as below. When calling <code>histogram</code>, we also specify 30 bins explicitly. You can also fine tune the figure using <code>spec</code> named parameter to specify the colour, x range, y range, and etc. We will discuss in details on how to use Owl to plot in a separate chapter.</p>
<div class="highlight">
<pre><code class="language-ocaml">(* convert arrays to matrices *)

let x' = Mat.of_array x 1 999;;
let y' = Mat.of_array y 1 999;;

(* plot the figures *)

let h = Plot.create ~m:1 ~n:2 "plot_02.png" in

  Plot.subplot h 0 0;
  Plot.set_ylabel h "frequency";
  Plot.histogram ~bin:30 ~h x';
  Plot.histogram ~bin:30 ~h y';

  Plot.subplot h 0 1;
  Plot.set_ylabel h "PDF p(x)";
  Plot.plot_fun ~h (fun x -&gt; Stats.gaussian_pdf ~mu:1. ~sigma:1. x) (-2.) 6.;
  Plot.plot_fun ~h (fun x -&gt; Stats.gaussian_pdf ~mu:12. ~sigma:3. x) 0. 25.;

  Plot.output h;;</code></pre>
</div>
<p>In subplot 1, we can see the second data set has much wider spread. In subplot 2, we also plot corresponding the probability density functions of the two data sets.</p>
<figure>
<img alt="" style="width:90.0%" id="fig:stats:plot_02" title="plot 02" src="images/stats/plot_02.png"><figcaption>Figure 1: Probability density functions of two data sets</figcaption>
</figure>
<p>As an exercise, you can also try out other distributions like gamma, beta, chi2, and student-t distribution.</p>
</section>
<section class="level3" id="gamma-distribution">
<h3>Gamma Distribution</h3>
</section>
<section class="level3" id="beta-distribution">
<h3>Beta Distribution</h3>
</section>
<section class="level3" id="chi-square-distribution">
<h3>Chi-Square Distribution</h3>
</section>
<section class="level3" id="student-t-distribution">
<h3>Student-t Distribution</h3>
</section>
<section class="level3" id="cauchy-distribution">
<h3>Cauchy Distribution</h3>
</section>
</section>
<section class="level2" id="hypothesis-tests">
<h2>Hypothesis Tests</h2>
<section class="level3" id="basic-theory">
<h3>Basic Theory</h3>
<p>While decriptive statitics solely concern properties of the observed data, statistical inference focusses on studying whether the data set is sampled from a larger population. In other words, statistical inference make propositions about a population. Hypothesis test is an important method in inferential statistical analysis. There are two hypotheses proposed with regard to the statistical relationship between data sets.</p>
<ul>
<li>Null hypothesis <span class="math inline">\(H_0\)</span>: there is no relationship between two data sets.</li>
<li>Alternative hypothesis <span class="math inline">\(H_1\)</span>: there is statistically significant relationship between two data sets.</li>
</ul>
<p>Type I and Type II errors.</p>
</section>
<section class="level3" id="gaussian-distribution-in-hypothesis-testing">
<h3>Gaussian Distribution in Hypothesis Testing</h3>
<p>The <code>Stats</code> module in Owl supports many different kinds of hypothesis tests.</p>
<ul>
<li>Z-Test</li>
<li>Student’s T-Test</li>
<li>Paired Sample T-Test</li>
<li>Unpaired Sample T-Test</li>
<li>Kolmogorov-Smirnov Test</li>
<li>Chi-Square Variance Test</li>
<li>Jarque-Bera Test</li>
<li>Fisher’s Exact Test</li>
<li>Wald–Wolfowitz Runs Test</li>
<li>Mann-Whitney Rank Test</li>
<li>Wilcoxon Signed-rank Test</li>
</ul>
<p>Now let’s see how to perform a z-test in Owl. We first generate two data sets, both are drawn from Gaussian distribution but with different parameterisation. The first one <code>data_0</code> is drawn from <span class="math inline">\(\mathcal{N}(0, 1)\)</span>, while the second one <code>data_1</code> is drawn from <span class="math inline">\(\mathcal{N}(3, 1)\)</span>.</p>
<div class="highlight">
<pre><code class="language-ocaml">let data_0 = Array.init 10 (fun _ -&gt; Stats.gaussian_rvs ~mu:0. ~sigma:1.);;
let data_1 = Array.init 10 (fun _ -&gt; Stats.gaussian_rvs ~mu:3. ~sigma:1.);;</code></pre>
</div>
<p>Our hypothesis is that the data set is drawn from Gaussian distribution <span class="math inline">\(\mathcal{N}(0, 1)\)</span>. From the way we genereated the synthetic data, it is obvious that <code>data_0</code> will pass the test, but let’s see what Owl will test us using its <code>Stats.z_test</code> function.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">Stats.z_test ~mu:0. ~sigma:1. data_0;;
&gt;- : Owl_stats.hypothesis =
&gt;{Owl.Stats.reject = false; p_value = 0.226130273768103796;
&gt; score = 1.21038740185418425}
</code></pre>
</div>
<p>The returned result is a record with the following type definition. The fields are self-explained: <code>reject</code> field tells whether the null hypothesis is rejected, along with the p value and score calculated with the given data set.</p>
<div class="highlight">
<pre><code class="language-ocaml">type hypothesis = {
  reject : bool;
  p_value : float;
  score : float;
}</code></pre>
</div>
<p>From the previous result, we can see <code>reject = false</code>, indicating null hypothesis is rejected, therefore the data set <code>data_0</code> is drawn from <span class="math inline">\(\mathcal{N}(0, 1)\)</span>. How about the second data set then?</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">Stats.z_test ~mu:0. ~sigma:1. data_1;;
&gt;- : Owl_stats.hypothesis =
&gt;{Owl.Stats.reject = true; p_value = 5.50161535788588324e-16;
&gt; score = 8.09987396754499756}
</code></pre>
</div>
<p>As we expected, the null hypothesis is accepted with a very small p value. This indicates that <code>data_1</code> is drawn from a different distribution rather than assumed <span class="math inline">\(\mathcal{N}(0, 1)\)</span>.</p>
</section>
<section class="level3" id="two-sample-inferences">
<h3>Two-Sample Inferences</h3>
</section>
<section class="level3" id="goodness-of-fit-tests">
<h3>Goodness-of-fit Tests</h3>
</section>
<section class="level3" id="non-parametric-statistics">
<h3>Non-parametric Statistics</h3>
<p>Wilcoxon Tests</p>
</section>
</section>
<section class="level2" id="covariance-and-correlations">
<h2>Covariance and Correlations</h2>
<p>Correlation studies how strongly two variables are related. There are different ways of calculating correlation. For the first example, let’s look at Pearson correlation.</p>
<p><code>x</code> is our explanatory variable and we draw 50 random values uniformly from an interval between 0 and 10. Both <code>y</code> and <code>z</code> are response variables with a linear relation to <code>x</code>. The only difference is that we add different level of noise to the response variables. The noise values are generated from Gaussian distribution.</p>
<div class="highlight">
<pre><code class="language-ocaml">let noise sigma = Stats.gaussian_rvs ~mu:0. ~sigma;;
let x = Array.init 50 (fun _ -&gt; Stats.uniform_rvs 0. 10.);;
let y = Array.map (fun a -&gt; 2.5 *. a +. noise 1.) x;;
let z = Array.map (fun a -&gt; 2.5 *. a +. noise 8.) x;;</code></pre>
</div>
<p>It is easier to see the relation between two variables from a figure. Herein we use Owl’s Plplot module to make two scatter plots.</p>
<div class="highlight">
<pre><code class="language-ocaml">(* convert arrays to matrices *)

let x' = Mat.of_array x 1 50;;
let y' = Mat.of_array y 1 50;;
let z' = Mat.of_array z 1 50;;

(* plot the figures *)

let h = Plot.create ~m:1 ~n:2 "plot_01.png" in

  Plot.subplot h 0 0;
  Plot.set_xlabel h "x";
  Plot.set_ylabel h "y (sigma = 1)";
  Plot.scatter ~h x' y';

  Plot.subplot h 0 1;
  Plot.set_xlabel h "x";
  Plot.set_ylabel h "z (sigma = 8)";
  Plot.scatter ~h x' z';

  Plot.output h;;</code></pre>
</div>
<p>The subfigure 1 shows the functional relation between <code>x</code> and <code>y</code> whilst the subfiture 2 shows the relation between <code>x</code> and <code>z</code>. Because we have added higher-level noise to <code>z</code>, the points in the second figure are more diffused.</p>
<figure>
<img alt="" style="width:90.0%" id="fig:stats:plot_01" title="plot 01" src="images/stats/plot_01.png"><figcaption>Figure 2: Functional relation between <code>x</code> and the other two variables.</figcaption>
</figure>
<p>Intuitively, we can easily see there is stronger relation between <code>x</code> and <code>y</code> from the figures. But how about numerically? In many cases, numbers are preferred because they are easier to compare with by a computer. The following snippet calculates the Pearson correlation between <code>x</code> and <code>y</code>, as well as the correlation between <code>x</code> and <code>z</code>. As we see, the smaller correlation value indicates weaker linear relation between <code>x</code> and <code>z</code> comparing to that between <code>x</code> and <code>y</code>.</p>
<div class="highlight">
<pre data-filter-output=">" data-prompt="#" class="command-line"><code class="language-ocaml">Stats.corrcoef x y;;
&gt;- : float = 0.990347906532983
Stats.corrcoef x z;;
&gt;- : float = 0.705481278204883822
</code></pre>
</div>
</section>
<section class="level2" id="analysis-of-variance">
<h2>Analysis of Variance</h2>
</section>
</section>
</article></div><a href="ndarray.html" class="next-chapter"><div class="content"><h1><small>Next: Chapter 06</small>N-Dimensional Arrays</h1></div></a><footer><div class="content"><ul><li><a href="http://ocaml.xyz">ocaml.xyz</a></li><li><a href="https://github.com/ryanrhymes">GitHub</a></li></ul><p>Copyright 2017-2020 Liang Wang.</p></div></footer><script src="js/jquery.min.js"></script><script src="js/min/app-min.js"></script></body></html>